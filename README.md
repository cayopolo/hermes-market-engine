# hermes-market-engine
A real-time market data platform for learning FastAPI, PostgreSQL, WebSockets, and high-performance Python.

## Overview
Hermes Market Engine is a learning-driven project with a goal to build a small but "production-inspired" market data platform capa ble of:
- Listening to an exchangeâ€™s real-time WebSocket stream
- Maintaining an accurate, queryable orderbook
- Computing core orderbook analytics such as spread, mid-price, imbalance, VWAP and so on
- Exposing the data through a clean FastAPI interface with autogenerated OpenAPI documentation
- Using PostgreSQL as the main storage layer
- Potentially experimenting with JIT-compiled logic (Numba) for high-speed orderbook and analytics calculations

## Quick Start

### 1. Setup Database

```bash
docker-compose up -d
```

For detailed setup instructions, see [DATABASE_SETUP.md](docs/DATABASE_SETUP.md)

### 2. Run Services

```bash
uv run hermes
```

This starts:
- **Data Collection Service**: Connects to Coinbase WebSocket, ingests level2 orderbook updates
- **Analytics Service**: Processes messages via Redis, maintains in-memory orderbook
- **FastAPI Server**: HTTP API listening on http://localhost:8000

Optional: control logging level with `--log-level debug|info|warning|error`

### 3. Access the API

**Interactive Documentation**:
- Swagger UI: http://localhost:8000/docs
- ReDoc: http://localhost:8000/redoc

**Query Current Analytics**:
```bash
curl http://localhost:8000/analytics/current
```

**Get Orderbook Snapshot**:
```bash
curl http://localhost:8000/orderbook/snapshot?depth=5
```

### API Endpoints

#### Analytics Endpoints (`/analytics`)
| Endpoint | Description |
|----------|-------------|
| `GET /analytics/current` | Full analytics snapshot (spread, midprice, imbalance, VWAP) |
| `GET /analytics/spread` | Current bid-ask spread |
| `GET /analytics/midprice` | Current mid-price |

#### Orderbook Endpoints (`/orderbook`)
| Endpoint | Description |
|----------|-------------|
| `GET /orderbook/snapshot?depth=N` | Current orderbook with top N levels (default: 10) |
| `GET /orderbook/bids?depth=N` | Best bid levels |
| `GET /orderbook/asks?depth=N` | Best ask levels |

#### History Endpoints (`/history`)
| Endpoint | Description |
|----------|-------------|
| `GET /history/raw-events` | Query historical raw events from database by time range and product |

All endpoints provide **real-time data** with **<1ms latency** by querying the in-memory analytics engine.

---

## Project Goals

Gain hands-on experience with:

- FastAPI & async HTTP servers
- PostgreSQL schema design & connection pooling
- WebSockets & async IO with exponential backoff
- Real-time orderbook data structures
- Potentially: JIT-compiled logic (Numba) for high-speed calculations